{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6","webpack:///webpack/bootstrap e47b43fd317ae6a829eb?24fc","webpack:///./src/service/ServiceStub.js?3e7b","webpack:///./src/util/Type.js?cda2","webpack:///./src/util/Status.js?d157","webpack:///./src/service/index.js?d231","webpack:///./src/util/index.js?6684","webpack:///./src/service/CustomEventService.js?0c83","webpack:///./src/service/LocalStorageService.js?1a2e","webpack:///./src/service/PostMessageService.js?9987","webpack:///./src/service/WKWebViewService.js?0660","webpack:///./src/role/Server.js","webpack:///./src/server.js"],"names":["ServiceStub","options","_type","type","_receiveListener","receiveMessageCallback","isClient","CLIENT","isServer","SERVER","getServiceName","post","dispatch","data","Type","Status","METHOD_NOT_FOUND","METHOD_SUCCESS","METHOD_ERROR","METHOD_ASYNC","METHOD_READY","METHOD_DESTROY","METHOD_TIMEOUT","CustomEventService","LocalStorageService","PostMessageService","WKWebViewService","window","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","document","createEvent","initCustomEvent","prototype","Event","_sourceElement","source","_targetElement","target","_eventName","addEventListener","bind","ev","dispatchEvent","destroy","removeEventListener","usedStorageKeys","_storageKey","storageKey","localStorage","removeItem","time","Date","getTime","setItem","JSON","stringify","key","newValue","parse","e","_targetWindow","_sourceWindow","_origin","origin","_verifySource","postMessage","_namespace","namespace","_callback","callbackName","hasMsgHandler","webkit","messageHandlers","strData","Server","methods","service","_connectionEstablished","_onReady","onReady","_receiveMessage","_serviceClass","_service","_token","_methods","addMethod","methodName","methodFn","removeMethod","jsonrpc","id","method","verify","token","test","_sendError","status","message","that","cb","done","_sendResult","error","methodObj","isAsync","async","result"],"mappings":"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","file":"server.rpcservice.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"RPCService\"] = factory();\n\telse\n\t\troot[\"RPCService\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e47b43fd317ae6a829eb","import {Type} from '../util/Type'\n\nexport class ServiceStub {\n\n  constructor(options) {\n    this._type = options.type;\n    this._receiveListener = options.receiveMessageCallback;\n  }\n\n  isClient() {\n    return this._type === Type.CLIENT;\n  }\n\n  isServer() {\n    return this._type === Type.SERVER;\n  }\n\n  /**\n   *\n   */\n  static getServiceName() {\n    throw \"not implemented yet\";\n  }\n\n  /**\n   * to be implemented in the subclass\n   */\n  post() {\n    throw \"post not implemented yet\";\n  }\n\n  /**\n   * forward dispatched data the registered listener\n   * @param data\n   */\n  dispatch(data) {\n    this._receiveListener(data);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/ServiceStub.js","\nexport const Type = {\n  SERVER: 'SERVER',\n  CLIENT: 'CLIENT'\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/Type.js","\nexport const Status = {\n  METHOD_NOT_FOUND: 'METHOD_NOT_FOUND',\n  METHOD_SUCCESS: 'METHOD_SUCCESS',\n  METHOD_ERROR: 'METHOD_ERROR',\n  METHOD_ASYNC: 'METHOD_ASYNC',\n  METHOD_READY: 'METHOD_READY',\n  METHOD_DESTROY: 'METHOD_DESTROY',\n  METHOD_TIMEOUT: 'METHOD_TIMEOUT'\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/Status.js","\nexport {ServiceStub} from './ServiceStub';\nexport {CustomEventService} from './CustomEventService';\nexport {LocalStorageService} from './LocalStorageService';\nexport {PostMessageService} from './PostMessageService';\nexport {WKWebViewService} from './WKWebViewService';\n\n\n// WEBPACK FOOTER //\n// ./src/service/index.js","\nexport {Status} from './Status'\nexport {Type} from './Type'\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/index.js","import {ServiceStub} from './ServiceStub';\n\n// polyfill for IE 10\n(function () {\n\n  if ( typeof window.CustomEvent === \"function\" ) return false;\n\n  function CustomEvent(event, params) {\n    params = params || { bubbles: false, cancelable: false, detail: undefined };\n    var evt = document.createEvent('CustomEvent');\n    evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n    return evt;\n  }\n\n  CustomEvent.prototype = window.Event.prototype;\n  window.CustomEvent = CustomEvent;\n})();\n\n\nexport class CustomEventService extends ServiceStub {\n\n  constructor(options = {}) {\n    super(options);\n\n    this._sourceElement = options.source || window;\n    this._targetElement = options.target || this._sourceElement;\n    this._eventName     = options.event || 'message';\n\n    this._sourceElement.addEventListener(this._eventName, this.dispatch.bind(this), false);\n  }\n\n  static getServiceName() {\n    return 'CustomEventService'\n  }\n\n  /**\n   * Send a message by using `postMessage` service.\n   * @param {object} data\n   */\n  post(data) {\n    data.source = this._type;\n    const ev = new CustomEvent(this._eventName, {\n      detail: data\n    });\n    this._targetElement.dispatchEvent(ev);\n  }\n\n  /**\n   * Handles received messages\n   * @param {object} detail\n   * @returns {*}\n   */\n  dispatch({detail}) {\n    // ensure provider or customer doesn't dispatch its own message\n    if (detail && detail.source !== this._type) {\n      delete detail.source;\n      super.dispatch(detail);\n    }\n  }\n\n  /**\n   * remove bindings\n   */\n  destroy() {\n    this._sourceElement.removeEventListener(this._eventName, this.dispatch);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/CustomEventService.js","import {ServiceStub} from './ServiceStub';\n\nlet usedStorageKeys = {};\n\nexport class LocalStorageService extends ServiceStub {\n\n  constructor(options) {\n    super(options);\n\n    this._storageKey = options.storageKey || 'rpc:message';\n\n    if (usedStorageKeys[this._storageKey]) {\n      throw `LocalStorageService: key '${this._storageKey}' is already in use by another LocalStorageService`;\n    }\n    usedStorageKeys[this._storageKey] = true;\n\n    // remove old data if exists\n    localStorage.removeItem(this._storageKey);\n\n    window.addEventListener('storage', this.dispatch.bind(this), false);\n  }\n\n  static getServiceName() {\n    return 'LocalStorageService'\n  }\n\n  /**\n   * Send a message by using `localStorage`\n   * @param {object} data\n   */\n  post(data) {\n    data.time = new Date().getTime();\n    data.source = this._type;\n    localStorage.setItem(this._storageKey, JSON.stringify(data));\n  }\n\n  /**\n   * Handles received messages\n   * @param key\n   * @param newValue\n   */\n  dispatch({key, newValue}) {\n\n    if (newValue && key === this._storageKey) {\n      try {\n        const data = JSON.parse(newValue);\n        delete data.time;\n\n        // ensure provider or customer doesn't dispatch its own message\n        if (data.source !== this._type) {\n          delete data.source;\n          super.dispatch(data);\n        }\n      } catch(e) {}\n    }\n  }\n\n  /**\n   * remove bindings\n   */\n  destroy() {\n    window.removeEventListener('storage', this.dispatch);\n    localStorage.removeItem(this._storageKey);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/LocalStorageService.js","import {ServiceStub} from './ServiceStub';\n\nexport class PostMessageService extends ServiceStub {\n\n  constructor(options = {}) {\n    super(options);\n\n    this._targetWindow = options.target || null;\n    this._sourceWindow = options.source || window;\n    this._origin       = options.origin || \"*\";\n    this._verifySource = this._origin !== '*';\n\n    this._sourceWindow.addEventListener('message', this.dispatch.bind(this), false);\n  }\n\n  static getServiceName() {\n    return 'PostMessageService'\n  }\n\n  /**\n   * Send a message by using `postMessage` service.\n   * @param {object} data\n   */\n  post(data) {\n\n    if (this._targetWindow === null) {\n      throw \"windows element for posting messages does not exist\";\n    }\n\n    this._targetWindow.postMessage(data, this._origin);\n  }\n\n  /**\n   * Handles received messages\n   * @param {string} origin\n   * @param {object} data\n   * @param {window} source\n   * @returns {*}\n   */\n  dispatch({origin, data, source}) {\n\n    if (this._verifySource && this._origin !== origin) {\n      return null;\n    }\n\n    super.dispatch(data);\n  }\n\n  /**\n   * remove bindings\n   */\n  destroy() {\n    this._sourceWindow.removeEventListener('message', this.dispatch);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/PostMessageService.js","import {ServiceStub} from './ServiceStub';\n\nexport class WKWebViewService extends ServiceStub {\n\n  constructor(options = {}) {\n    super(options);\n\n    this._namespace = options.namespace;\n    this._callback = options.callbackName || 'rpcReceiveCallback';\n    let hasMsgHandler = false;\n\n    // check if special WKWebView message handler exists\n    try {\n      hasMsgHandler = (typeof window.webkit.messageHandlers[this._namespace].postMessage === 'function');\n    } catch(e) {}\n\n    if (!hasMsgHandler) {\n      throw `WKWebViewService: cannot connect to WKWebView handler 'window.webkit.messageHandlers.${this._namespace}'`;\n    }\n\n    // register callback function (works as response listener)\n    window[this._callback] = this.dispatch.bind(this);\n  }\n\n  static getServiceName() {\n    return 'WKWebViewService'\n  }\n\n  /**\n   * Send a message by using `postMessage` service.\n   * @param {object} data\n   */\n  post(data) {\n    window.webkit.messageHandlers[this._namespace].postMessage(JSON.stringify(data));\n  }\n\n  /**\n   * Handles received messages\n   * @param {string} strData\n   * @returns {*}\n   */\n  dispatch(strData) {\n    try {\n      super.dispatch(JSON.parse(strData));\n    } catch(e) {}\n  }\n\n  /**\n   * remove bindings\n   */\n  destroy() {\n    delete window[this._namespace];\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/WKWebViewService.js","import {Status} from '../util/Status';\nimport {Type} from '../util/Type';\n\n\nexport class Server {\n\n  /**\n   *\n   * @param options -\n   * @param methods - function map\n   */\n  constructor(options, methods = {}) {\n\n    if (!options.service) {\n      throw \"missing option 'service' for service class\"\n    }\n\n    this._connectionEstablished = false;\n    this._onReady = typeof options.onReady === 'function' ? options.onReady : null;\n\n    options.type = Type.SERVER;\n    options.receiveMessageCallback = this._receiveMessage.bind(this);\n\n    this._serviceClass = options.service;\n    this._service = new this._serviceClass(options);\n    this._token = null;\n    this._methods = methods;\n  }\n\n  /**\n   * register given callback function with `methodName`\n   * @param methodName\n   * @param methodFn\n   * @returns {Consumer}\n   */\n  addMethod(methodName, methodFn) {\n    this._methods[methodName] = methodFn;\n    return this;\n  }\n\n  /**\n   * Remove callback function with given `methodName`\n   * @param methodName\n   */\n  removeMethod(methodName) {\n    if (this._methods[methodName]) {\n      delete this._methods[methodName];\n    }\n    return this;\n  }\n\n  /**\n   * Handles a message sent by a provider and invoke the method.\n   * @param jsonrpc\n   * @param id\n   * @param method\n   * @param params\n   * @param verify\n   * @param token\n   * @param test\n   * @returns {*}\n   * @private\n   */\n  _receiveMessage({jsonrpc, id, method, params, verify, token, test}) {\n\n    if (!this._connectionEstablished && verify && id) {\n      this._connectionEstablished = true;\n      this._token = id;\n      this._service.post({\n        verify,\n        id\n      });\n      if (this._onReady) {\n        this._onReady();\n      }\n    }\n\n    // check JSON RPC format for answer\n    if (!this._connectionEstablished || jsonrpc !== \"2.0\" || !id || !method || token !== this._token) {\n      return;\n    }\n\n    // message with given id does not exist\n    if (!this._methods[method]) {\n      return this._sendError(id, {\n        status: Status.METHOD_NOT_FOUND,\n        message: `method with name ${method} could not be found`\n      });\n    }\n\n    const that = this;\n    const cb = {\n      done(data) {\n        that._sendResult(id, {\n          status: Status.METHOD_SUCCESS,\n          data,\n        });\n      },\n      error(data) {\n        that._sendResult(id, {\n          status: Status.METHOD_ERROR,\n          data,\n        });\n      }\n    };\n    const methodObj = {\n      method: this._methods[method],\n      isAsync: false,\n      async: function() {\n        this.isAsync = true;\n        that._sendResult(id, {\n          status: Status.METHOD_ASYNC\n        });\n        return cb;\n      }\n    };\n\n    // invoke method\n    let result = methodObj.method(params, cb.done, cb.error);\n\n    // stop here if method works asynchronously\n    if (methodObj.isAsync) {\n      return;\n    }\n\n    // undefined result should work as success by documentation\n    if (result === undefined) {\n      result = true;\n    }\n\n    if (result === false || result === null) {\n      return cb.error();\n    }\n    return cb.done(result);\n  }\n\n  /**\n   * send `success` response to the provider\n   * @param id\n   * @param data\n   */\n  _sendResult(id, data) {\n    this._service.post({\n      jsonrpc: \"2.0\",\n      id,\n      result: data,\n    });\n  }\n\n  /**\n   * send `error` response to the provider\n   * @param id\n   * @param data\n   */\n  _sendError(id, data) {\n    this._service.post({\n      jsonrpc: \"2.0\",\n      id,\n      error: data,\n    });\n  }\n\n  destroy() {\n    this._service.destroy();\n    this._methods = {};\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/role/Server.js","\nexport * from './role/Server'\nexport * from './service/index'\nexport * from './util/index'\n\n\n// WEBPACK FOOTER //\n// ./src/server.js"],"sourceRoot":""}