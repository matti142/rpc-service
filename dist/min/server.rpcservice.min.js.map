{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6","webpack:///server.rpcservice.min.js","webpack:///webpack/bootstrap 0f6b2813d400aedec150?5bac","webpack:///./src/service/ServiceStub.js?3e7b","webpack:///./src/util/Type.js?cda2","webpack:///./src/service/index.js?d231","webpack:///./src/service/CustomEventService.js?0c83","webpack:///./src/service/LocalStorageService.js?1a2e","webpack:///./src/service/PostMessageService.js?9987","webpack:///./src/service/WKWebViewService.js?0660","webpack:///./src/util/Status.js?d157","webpack:///./src/role/Server.js","webpack:///./src/server.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_interopRequireDefault","obj","default","_classCallCheck","instance","Constructor","TypeError","ServiceStub","undefined","_Type","_Type2","options","_type","type","_receiveListener","receiveMessageCallback","isClient","CLIENT","isServer","SERVER","getServiceName","post","dispatch","data","Type","_ServiceStub","_CustomEventService","CustomEventService","_LocalStorageService","LocalStorageService","_PostMessageService","PostMessageService","_WKWebViewService","WKWebViewService","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","writable","setPrototypeOf","__proto__","_ServiceStub2","CustomEvent","event","params","bubbles","cancelable","detail","evt","document","createEvent","initCustomEvent","window","Event","arguments","length","_this","_sourceElement","source","_targetElement","target","_eventName","addEventListener","bind","ev","dispatchEvent","_ref","destroy","removeEventListener","usedStorageKeys","_storageKey","storageKey","localStorage","removeItem","time","Date","getTime","setItem","JSON","stringify","key","newValue","parse","e","_targetWindow","_sourceWindow","_origin","origin","_verifySource","postMessage","_namespace","namespace","_callback","callbackName","hasMsgHandler","webkit","messageHandlers","strData","Status","METHOD_NOT_FOUND","METHOD_SUCCESS","METHOD_ERROR","METHOD_ASYNC","METHOD_READY","METHOD_DESTROY","METHOD_TIMEOUT","Server","_Status","_Status2","methods","service","_connectionEstablished","_onReady","onReady","CONSUMER","_receiveMessage","_serviceClass","_service","_token","_methods","addMethod","methodName","methodFn","removeMethod","jsonrpc","id","method","verify","token","test","_sendError","status","message","that","cb","done","_sendResult","error","methodObj","isAsync","async","result","_Server","keys","forEach","_index"],"mappings":"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","file":"server.rpcservice.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"RPCService\"] = factory();\n\telse\n\t\troot[\"RPCService\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"RPCService\"] = factory();\n\telse\n\t\troot[\"RPCService\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 15);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ServiceStub = undefined;\n\nvar _Type = __webpack_require__(1);\n\nvar _Type2 = _interopRequireDefault(_Type);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ServiceStub = exports.ServiceStub = function () {\n  function ServiceStub(options) {\n    _classCallCheck(this, ServiceStub);\n\n    this._type = options.type;\n    this._receiveListener = options.receiveMessageCallback;\n  }\n\n  ServiceStub.prototype.isClient = function isClient() {\n    return this._type === _Type2.default.CLIENT;\n  };\n\n  ServiceStub.prototype.isServer = function isServer() {\n    return this._type === _Type2.default.SERVER;\n  };\n\n  /**\n   *\n   */\n\n\n  ServiceStub.getServiceName = function getServiceName() {\n    throw \"not implemented yet\";\n  };\n\n  /**\n   * to be implemented in the subclass\n   */\n\n\n  ServiceStub.prototype.post = function post() {\n    throw \"post not implemented yet\";\n  };\n\n  /**\n   * forward dispatched data the registered listener\n   * @param data\n   */\n\n\n  ServiceStub.prototype.dispatch = function dispatch(data) {\n    this._receiveListener(data);\n  };\n\n  return ServiceStub;\n}();\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Type = {\n  SERVER: 'SERVER',\n  CLIENT: 'CLIENT'\n};\n\nexports.default = Type;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _ServiceStub = __webpack_require__(0);\n\nObject.defineProperty(exports, 'ServiceStub', {\n  enumerable: true,\n  get: function get() {\n    return _ServiceStub.ServiceStub;\n  }\n});\n\nvar _CustomEventService = __webpack_require__(3);\n\nObject.defineProperty(exports, 'CustomEventService', {\n  enumerable: true,\n  get: function get() {\n    return _CustomEventService.CustomEventService;\n  }\n});\n\nvar _LocalStorageService = __webpack_require__(4);\n\nObject.defineProperty(exports, 'LocalStorageService', {\n  enumerable: true,\n  get: function get() {\n    return _LocalStorageService.LocalStorageService;\n  }\n});\n\nvar _PostMessageService = __webpack_require__(5);\n\nObject.defineProperty(exports, 'PostMessageService', {\n  enumerable: true,\n  get: function get() {\n    return _PostMessageService.PostMessageService;\n  }\n});\n\nvar _WKWebViewService = __webpack_require__(6);\n\nObject.defineProperty(exports, 'WKWebViewService', {\n  enumerable: true,\n  get: function get() {\n    return _WKWebViewService.WKWebViewService;\n  }\n});\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CustomEventService = undefined;\n\nvar _ServiceStub2 = __webpack_require__(0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n// polyfill for IE 10\n(function () {\n\n  if (typeof window.CustomEvent === \"function\") return false;\n\n  function CustomEvent(event, params) {\n    params = params || { bubbles: false, cancelable: false, detail: undefined };\n    var evt = document.createEvent('CustomEvent');\n    evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n    return evt;\n  }\n\n  CustomEvent.prototype = window.Event.prototype;\n  window.CustomEvent = CustomEvent;\n})();\n\nvar CustomEventService = exports.CustomEventService = function (_ServiceStub) {\n  _inherits(CustomEventService, _ServiceStub);\n\n  function CustomEventService() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, CustomEventService);\n\n    var _this = _possibleConstructorReturn(this, _ServiceStub.call(this, options));\n\n    _this._sourceElement = options.source || window;\n    _this._targetElement = options.target || _this._sourceElement;\n    _this._eventName = options.event || 'message';\n\n    _this._sourceElement.addEventListener(_this._eventName, _this.dispatch.bind(_this), false);\n    return _this;\n  }\n\n  CustomEventService.getServiceName = function getServiceName() {\n    return 'CustomEventService';\n  };\n\n  /**\n   * Send a message by using `postMessage` service.\n   * @param {object} data\n   */\n\n\n  CustomEventService.prototype.post = function post(data) {\n    data.source = this._type;\n    var ev = new CustomEvent(this._eventName, {\n      detail: data\n    });\n    this._targetElement.dispatchEvent(ev);\n  };\n\n  /**\n   * Handles received messages\n   * @param {object} detail\n   * @returns {*}\n   */\n\n\n  CustomEventService.prototype.dispatch = function dispatch(_ref) {\n    var detail = _ref.detail;\n\n    // ensure provider or customer doesn't dispatch its own message\n    if (detail && detail.source !== this._type) {\n      delete detail.source;\n      _ServiceStub.prototype.dispatch.call(this, detail);\n    }\n  };\n\n  /**\n   * remove bindings\n   */\n\n\n  CustomEventService.prototype.destroy = function destroy() {\n    this._sourceElement.removeEventListener(this._eventName, this.dispatch);\n  };\n\n  return CustomEventService;\n}(_ServiceStub2.ServiceStub);\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.LocalStorageService = undefined;\n\nvar _ServiceStub2 = __webpack_require__(0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar usedStorageKeys = {};\n\nvar LocalStorageService = exports.LocalStorageService = function (_ServiceStub) {\n  _inherits(LocalStorageService, _ServiceStub);\n\n  function LocalStorageService(options) {\n    _classCallCheck(this, LocalStorageService);\n\n    var _this = _possibleConstructorReturn(this, _ServiceStub.call(this, options));\n\n    _this._storageKey = options.storageKey || 'rpc:message';\n\n    if (usedStorageKeys[_this._storageKey]) {\n      throw 'LocalStorageService: key \\'' + _this._storageKey + '\\' is already in use by another LocalStorageService';\n    }\n    usedStorageKeys[_this._storageKey] = true;\n\n    // remove old data if exists\n    localStorage.removeItem(_this._storageKey);\n\n    window.addEventListener('storage', _this.dispatch.bind(_this), false);\n    return _this;\n  }\n\n  LocalStorageService.getServiceName = function getServiceName() {\n    return 'LocalStorageService';\n  };\n\n  /**\n   * Send a message by using `localStorage`\n   * @param {object} data\n   */\n\n\n  LocalStorageService.prototype.post = function post(data) {\n    data.time = new Date().getTime();\n    data.source = this._type;\n    localStorage.setItem(this._storageKey, JSON.stringify(data));\n  };\n\n  /**\n   * Handles received messages\n   * @param key\n   * @param newValue\n   */\n\n\n  LocalStorageService.prototype.dispatch = function dispatch(_ref) {\n    var key = _ref.key,\n        newValue = _ref.newValue;\n\n\n    if (newValue && key === this._storageKey) {\n      try {\n        var data = JSON.parse(newValue);\n        delete data.time;\n\n        // ensure provider or customer doesn't dispatch its own message\n        if (data.source !== this._type) {\n          delete data.source;\n          _ServiceStub.prototype.dispatch.call(this, data);\n        }\n      } catch (e) {}\n    }\n  };\n\n  /**\n   * remove bindings\n   */\n\n\n  LocalStorageService.prototype.destroy = function destroy() {\n    window.removeEventListener('storage', this.dispatch);\n    localStorage.removeItem(this._storageKey);\n  };\n\n  return LocalStorageService;\n}(_ServiceStub2.ServiceStub);\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PostMessageService = undefined;\n\nvar _ServiceStub2 = __webpack_require__(0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar PostMessageService = exports.PostMessageService = function (_ServiceStub) {\n  _inherits(PostMessageService, _ServiceStub);\n\n  function PostMessageService() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, PostMessageService);\n\n    var _this = _possibleConstructorReturn(this, _ServiceStub.call(this, options));\n\n    _this._targetWindow = options.target || null;\n    _this._sourceWindow = options.source || window;\n    _this._origin = options.origin || \"*\";\n    _this._verifySource = _this._origin !== '*';\n\n    _this._sourceWindow.addEventListener('message', _this.dispatch.bind(_this), false);\n    return _this;\n  }\n\n  PostMessageService.getServiceName = function getServiceName() {\n    return 'PostMessageService';\n  };\n\n  /**\n   * Send a message by using `postMessage` service.\n   * @param {object} data\n   */\n\n\n  PostMessageService.prototype.post = function post(data) {\n\n    if (this._targetWindow === null) {\n      throw \"windows element for posting messages does not exist\";\n    }\n\n    this._targetWindow.postMessage(data, this._origin);\n  };\n\n  /**\n   * Handles received messages\n   * @param {string} origin\n   * @param {object} data\n   * @param {window} source\n   * @returns {*}\n   */\n\n\n  PostMessageService.prototype.dispatch = function dispatch(_ref) {\n    var origin = _ref.origin,\n        data = _ref.data,\n        source = _ref.source;\n\n\n    if (this._verifySource && this._origin !== origin) {\n      return null;\n    }\n\n    _ServiceStub.prototype.dispatch.call(this, data);\n  };\n\n  /**\n   * remove bindings\n   */\n\n\n  PostMessageService.prototype.destroy = function destroy() {\n    this._sourceWindow.removeEventListener('message', this.dispatch);\n  };\n\n  return PostMessageService;\n}(_ServiceStub2.ServiceStub);\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.WKWebViewService = undefined;\n\nvar _ServiceStub2 = __webpack_require__(0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar WKWebViewService = exports.WKWebViewService = function (_ServiceStub) {\n  _inherits(WKWebViewService, _ServiceStub);\n\n  function WKWebViewService() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, WKWebViewService);\n\n    var _this = _possibleConstructorReturn(this, _ServiceStub.call(this, options));\n\n    _this._namespace = options.namespace;\n    _this._callback = options.callbackName || 'rpcReceiveCallback';\n    var hasMsgHandler = false;\n\n    // check if special WKWebView message handler exists\n    try {\n      hasMsgHandler = typeof window.webkit.messageHandlers[_this._namespace].postMessage === 'function';\n    } catch (e) {}\n\n    if (!hasMsgHandler) {\n      throw 'WKWebViewService: cannot connect to WKWebView handler \\'window.webkit.messageHandlers.' + _this._namespace + '\\'';\n    }\n\n    // register callback function (works as response listener)\n    window[_this._callback] = _this.dispatch.bind(_this);\n    return _this;\n  }\n\n  WKWebViewService.getServiceName = function getServiceName() {\n    return 'WKWebViewService';\n  };\n\n  /**\n   * Send a message by using `postMessage` service.\n   * @param {object} data\n   */\n\n\n  WKWebViewService.prototype.post = function post(data) {\n    window.webkit.messageHandlers[this._namespace].postMessage(JSON.stringify(data));\n  };\n\n  /**\n   * Handles received messages\n   * @param {string} strData\n   * @returns {*}\n   */\n\n\n  WKWebViewService.prototype.dispatch = function dispatch(strData) {\n    try {\n      _ServiceStub.prototype.dispatch.call(this, JSON.parse(strData));\n    } catch (e) {}\n  };\n\n  /**\n   * remove bindings\n   */\n\n\n  WKWebViewService.prototype.destroy = function destroy() {\n    delete window[this._namespace];\n  };\n\n  return WKWebViewService;\n}(_ServiceStub2.ServiceStub);\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Status = {\n  METHOD_NOT_FOUND: 'METHOD_NOT_FOUND',\n  METHOD_SUCCESS: 'METHOD_SUCCESS',\n  METHOD_ERROR: 'METHOD_ERROR',\n  METHOD_ASYNC: 'METHOD_ASYNC',\n  METHOD_READY: 'METHOD_READY',\n  METHOD_DESTROY: 'METHOD_DESTROY',\n  METHOD_TIMEOUT: 'METHOD_TIMEOUT'\n};\n\nexports.default = Status;\n\n/***/ }),\n/* 8 */,\n/* 9 */,\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Server = undefined;\n\nvar _Status = __webpack_require__(7);\n\nvar _Status2 = _interopRequireDefault(_Status);\n\nvar _Type = __webpack_require__(1);\n\nvar _Type2 = _interopRequireDefault(_Type);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Server = exports.Server = function () {\n\n  /**\n   *\n   * @param options -\n   * @param methods - function map\n   */\n  function Server(options) {\n    var methods = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Server);\n\n    if (!options.service) {\n      throw \"missing option 'service' for service class\";\n    }\n\n    this._connectionEstablished = false;\n    this._onReady = typeof options.onReady === 'function' ? options.onReady : null;\n\n    options.type = _Type2.default.CONSUMER;\n    options.receiveMessageCallback = this._receiveMessage.bind(this);\n\n    this._serviceClass = options.service;\n    this._service = new this._serviceClass(options);\n    this._token = null;\n    this._methods = methods;\n  }\n\n  /**\n   * register given callback function with `methodName`\n   * @param methodName\n   * @param methodFn\n   * @returns {Consumer}\n   */\n\n\n  Server.prototype.addMethod = function addMethod(methodName, methodFn) {\n    this._methods[methodName] = methodFn;\n    return this;\n  };\n\n  /**\n   * Remove callback function with given `methodName`\n   * @param methodName\n   */\n\n\n  Server.prototype.removeMethod = function removeMethod(methodName) {\n    if (this._methods[methodName]) {\n      delete this._methods[methodName];\n    }\n    return this;\n  };\n\n  /**\n   * Handles a message sent by a provider and invoke the method.\n   * @param jsonrpc\n   * @param id\n   * @param method\n   * @param params\n   * @param verify\n   * @param token\n   * @param test\n   * @returns {*}\n   * @private\n   */\n\n\n  Server.prototype._receiveMessage = function _receiveMessage(_ref) {\n    var jsonrpc = _ref.jsonrpc,\n        id = _ref.id,\n        method = _ref.method,\n        params = _ref.params,\n        verify = _ref.verify,\n        token = _ref.token,\n        test = _ref.test;\n\n\n    if (!this._connectionEstablished && verify && id) {\n      this._connectionEstablished = true;\n      this._token = id;\n      this._service.post({\n        verify: verify,\n        id: id\n      });\n      if (this._onReady) {\n        this._onReady();\n      }\n    }\n\n    // check JSON RPC format for answer\n    if (!this._connectionEstablished || jsonrpc !== \"2.0\" || !id || !method || token !== this._token) {\n      return;\n    }\n\n    // message with given id does not exist\n    if (!this._methods[method]) {\n      return this._sendError(id, {\n        status: _Status2.default.METHOD_NOT_FOUND,\n        message: 'method with name ' + method + ' could not be found'\n      });\n    }\n\n    var that = this;\n    var cb = {\n      done: function done(data) {\n        that._sendResult(id, {\n          status: _Status2.default.METHOD_SUCCESS,\n          data: data\n        });\n      },\n      error: function error(data) {\n        that._sendResult(id, {\n          status: _Status2.default.METHOD_ERROR,\n          data: data\n        });\n      }\n    };\n    var methodObj = {\n      method: this._methods[method],\n      isAsync: false,\n      async: function async() {\n        this.isAsync = true;\n        that._sendResult(id, {\n          status: _Status2.default.METHOD_ASYNC\n        });\n        return cb;\n      }\n    };\n\n    // invoke method\n    var result = methodObj.method(params, cb.done, cb.error);\n\n    // stop here if method works asynchronously\n    if (methodObj.isAsync) {\n      return;\n    }\n\n    // undefined result should work as success by documentation\n    if (result === undefined) {\n      result = true;\n    }\n\n    if (result === false || result === null) {\n      return cb.error();\n    }\n    return cb.done(result);\n  };\n\n  /**\n   * send `success` response to the provider\n   * @param id\n   * @param data\n   */\n\n\n  Server.prototype._sendResult = function _sendResult(id, data) {\n    this._service.post({\n      jsonrpc: \"2.0\",\n      id: id,\n      result: data\n    });\n  };\n\n  /**\n   * send `error` response to the provider\n   * @param id\n   * @param data\n   */\n\n\n  Server.prototype._sendError = function _sendError(id, data) {\n    this._service.post({\n      jsonrpc: \"2.0\",\n      id: id,\n      error: data\n    });\n  };\n\n  Server.prototype.destroy = function destroy() {\n    this._service.destroy();\n    this._methods = {};\n  };\n\n  return Server;\n}();\n\n/***/ }),\n/* 11 */,\n/* 12 */,\n/* 13 */,\n/* 14 */,\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _Server = __webpack_require__(10);\n\nObject.keys(_Server).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _Server[key];\n    }\n  });\n});\n\nvar _index = __webpack_require__(2);\n\nObject.keys(_index).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _index[key];\n    }\n  });\n});\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// server.rpcservice.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 15);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 0f6b2813d400aedec150","import Type from '../util/Type'\n\nexport class ServiceStub {\n\n  constructor(options) {\n    this._type = options.type;\n    this._receiveListener = options.receiveMessageCallback;\n  }\n\n  isClient() {\n    return this._type === Type.CLIENT;\n  }\n\n  isServer() {\n    return this._type === Type.SERVER;\n  }\n\n  /**\n   *\n   */\n  static getServiceName() {\n    throw \"not implemented yet\";\n  }\n\n  /**\n   * to be implemented in the subclass\n   */\n  post() {\n    throw \"post not implemented yet\";\n  }\n\n  /**\n   * forward dispatched data the registered listener\n   * @param data\n   */\n  dispatch(data) {\n    this._receiveListener(data);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/ServiceStub.js","\nconst Type = {\n  SERVER: 'SERVER',\n  CLIENT: 'CLIENT'\n};\n\nexport default Type;\n\n\n// WEBPACK FOOTER //\n// ./src/util/Type.js","\nexport {ServiceStub} from './ServiceStub';\nexport {CustomEventService} from './CustomEventService';\nexport {LocalStorageService} from './LocalStorageService';\nexport {PostMessageService} from './PostMessageService';\nexport {WKWebViewService} from './WKWebViewService';\n\n\n// WEBPACK FOOTER //\n// ./src/service/index.js","import {ServiceStub} from './ServiceStub';\n\n// polyfill for IE 10\n(function () {\n\n  if ( typeof window.CustomEvent === \"function\" ) return false;\n\n  function CustomEvent(event, params) {\n    params = params || { bubbles: false, cancelable: false, detail: undefined };\n    var evt = document.createEvent('CustomEvent');\n    evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n    return evt;\n  }\n\n  CustomEvent.prototype = window.Event.prototype;\n  window.CustomEvent = CustomEvent;\n})();\n\n\nexport class CustomEventService extends ServiceStub {\n\n  constructor(options = {}) {\n    super(options);\n\n    this._sourceElement = options.source || window;\n    this._targetElement = options.target || this._sourceElement;\n    this._eventName     = options.event || 'message';\n\n    this._sourceElement.addEventListener(this._eventName, this.dispatch.bind(this), false);\n  }\n\n  static getServiceName() {\n    return 'CustomEventService'\n  }\n\n  /**\n   * Send a message by using `postMessage` service.\n   * @param {object} data\n   */\n  post(data) {\n    data.source = this._type;\n    const ev = new CustomEvent(this._eventName, {\n      detail: data\n    });\n    this._targetElement.dispatchEvent(ev);\n  }\n\n  /**\n   * Handles received messages\n   * @param {object} detail\n   * @returns {*}\n   */\n  dispatch({detail}) {\n    // ensure provider or customer doesn't dispatch its own message\n    if (detail && detail.source !== this._type) {\n      delete detail.source;\n      super.dispatch(detail);\n    }\n  }\n\n  /**\n   * remove bindings\n   */\n  destroy() {\n    this._sourceElement.removeEventListener(this._eventName, this.dispatch);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/CustomEventService.js","import {ServiceStub} from './ServiceStub';\n\nlet usedStorageKeys = {};\n\nexport class LocalStorageService extends ServiceStub {\n\n  constructor(options) {\n    super(options);\n\n    this._storageKey = options.storageKey || 'rpc:message';\n\n    if (usedStorageKeys[this._storageKey]) {\n      throw `LocalStorageService: key '${this._storageKey}' is already in use by another LocalStorageService`;\n    }\n    usedStorageKeys[this._storageKey] = true;\n\n    // remove old data if exists\n    localStorage.removeItem(this._storageKey);\n\n    window.addEventListener('storage', this.dispatch.bind(this), false);\n  }\n\n  static getServiceName() {\n    return 'LocalStorageService'\n  }\n\n  /**\n   * Send a message by using `localStorage`\n   * @param {object} data\n   */\n  post(data) {\n    data.time = new Date().getTime();\n    data.source = this._type;\n    localStorage.setItem(this._storageKey, JSON.stringify(data));\n  }\n\n  /**\n   * Handles received messages\n   * @param key\n   * @param newValue\n   */\n  dispatch({key, newValue}) {\n\n    if (newValue && key === this._storageKey) {\n      try {\n        const data = JSON.parse(newValue);\n        delete data.time;\n\n        // ensure provider or customer doesn't dispatch its own message\n        if (data.source !== this._type) {\n          delete data.source;\n          super.dispatch(data);\n        }\n      } catch(e) {}\n    }\n  }\n\n  /**\n   * remove bindings\n   */\n  destroy() {\n    window.removeEventListener('storage', this.dispatch);\n    localStorage.removeItem(this._storageKey);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/LocalStorageService.js","import {ServiceStub} from './ServiceStub';\n\nexport class PostMessageService extends ServiceStub {\n\n  constructor(options = {}) {\n    super(options);\n\n    this._targetWindow = options.target || null;\n    this._sourceWindow = options.source || window;\n    this._origin       = options.origin || \"*\";\n    this._verifySource = this._origin !== '*';\n\n    this._sourceWindow.addEventListener('message', this.dispatch.bind(this), false);\n  }\n\n  static getServiceName() {\n    return 'PostMessageService'\n  }\n\n  /**\n   * Send a message by using `postMessage` service.\n   * @param {object} data\n   */\n  post(data) {\n\n    if (this._targetWindow === null) {\n      throw \"windows element for posting messages does not exist\";\n    }\n\n    this._targetWindow.postMessage(data, this._origin);\n  }\n\n  /**\n   * Handles received messages\n   * @param {string} origin\n   * @param {object} data\n   * @param {window} source\n   * @returns {*}\n   */\n  dispatch({origin, data, source}) {\n\n    if (this._verifySource && this._origin !== origin) {\n      return null;\n    }\n\n    super.dispatch(data);\n  }\n\n  /**\n   * remove bindings\n   */\n  destroy() {\n    this._sourceWindow.removeEventListener('message', this.dispatch);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/PostMessageService.js","import {ServiceStub} from './ServiceStub';\n\nexport class WKWebViewService extends ServiceStub {\n\n  constructor(options = {}) {\n    super(options);\n\n    this._namespace = options.namespace;\n    this._callback = options.callbackName || 'rpcReceiveCallback';\n    let hasMsgHandler = false;\n\n    // check if special WKWebView message handler exists\n    try {\n      hasMsgHandler = (typeof window.webkit.messageHandlers[this._namespace].postMessage === 'function');\n    } catch(e) {}\n\n    if (!hasMsgHandler) {\n      throw `WKWebViewService: cannot connect to WKWebView handler 'window.webkit.messageHandlers.${this._namespace}'`;\n    }\n\n    // register callback function (works as response listener)\n    window[this._callback] = this.dispatch.bind(this);\n  }\n\n  static getServiceName() {\n    return 'WKWebViewService'\n  }\n\n  /**\n   * Send a message by using `postMessage` service.\n   * @param {object} data\n   */\n  post(data) {\n    window.webkit.messageHandlers[this._namespace].postMessage(JSON.stringify(data));\n  }\n\n  /**\n   * Handles received messages\n   * @param {string} strData\n   * @returns {*}\n   */\n  dispatch(strData) {\n    try {\n      super.dispatch(JSON.parse(strData));\n    } catch(e) {}\n  }\n\n  /**\n   * remove bindings\n   */\n  destroy() {\n    delete window[this._namespace];\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/WKWebViewService.js","\nconst Status = {\n  METHOD_NOT_FOUND: 'METHOD_NOT_FOUND',\n  METHOD_SUCCESS: 'METHOD_SUCCESS',\n  METHOD_ERROR: 'METHOD_ERROR',\n  METHOD_ASYNC: 'METHOD_ASYNC',\n  METHOD_READY: 'METHOD_READY',\n  METHOD_DESTROY: 'METHOD_DESTROY',\n  METHOD_TIMEOUT: 'METHOD_TIMEOUT'\n};\n\nexport default Status;\n\n\n// WEBPACK FOOTER //\n// ./src/util/Status.js","import Status from '../util/Status';\nimport Type from '../util/Type';\n\n\nexport class Server {\n\n  /**\n   *\n   * @param options -\n   * @param methods - function map\n   */\n  constructor(options, methods = {}) {\n\n    if (!options.service) {\n      throw \"missing option 'service' for service class\"\n    }\n\n    this._connectionEstablished = false;\n    this._onReady = typeof options.onReady === 'function' ? options.onReady : null;\n\n    options.type = Type.CONSUMER;\n    options.receiveMessageCallback = this._receiveMessage.bind(this);\n\n    this._serviceClass = options.service;\n    this._service = new this._serviceClass(options);\n    this._token = null;\n    this._methods = methods;\n  }\n\n  /**\n   * register given callback function with `methodName`\n   * @param methodName\n   * @param methodFn\n   * @returns {Consumer}\n   */\n  addMethod(methodName, methodFn) {\n    this._methods[methodName] = methodFn;\n    return this;\n  }\n\n  /**\n   * Remove callback function with given `methodName`\n   * @param methodName\n   */\n  removeMethod(methodName) {\n    if (this._methods[methodName]) {\n      delete this._methods[methodName];\n    }\n    return this;\n  }\n\n  /**\n   * Handles a message sent by a provider and invoke the method.\n   * @param jsonrpc\n   * @param id\n   * @param method\n   * @param params\n   * @param verify\n   * @param token\n   * @param test\n   * @returns {*}\n   * @private\n   */\n  _receiveMessage({jsonrpc, id, method, params, verify, token, test}) {\n\n    if (!this._connectionEstablished && verify && id) {\n      this._connectionEstablished = true;\n      this._token = id;\n      this._service.post({\n        verify,\n        id\n      });\n      if (this._onReady) {\n        this._onReady();\n      }\n    }\n\n    // check JSON RPC format for answer\n    if (!this._connectionEstablished || jsonrpc !== \"2.0\" || !id || !method || token !== this._token) {\n      return;\n    }\n\n    // message with given id does not exist\n    if (!this._methods[method]) {\n      return this._sendError(id, {\n        status: Status.METHOD_NOT_FOUND,\n        message: `method with name ${method} could not be found`\n      });\n    }\n\n    const that = this;\n    const cb = {\n      done(data) {\n        that._sendResult(id, {\n          status: Status.METHOD_SUCCESS,\n          data,\n        });\n      },\n      error(data) {\n        that._sendResult(id, {\n          status: Status.METHOD_ERROR,\n          data,\n        });\n      }\n    };\n    const methodObj = {\n      method: this._methods[method],\n      isAsync: false,\n      async: function() {\n        this.isAsync = true;\n        that._sendResult(id, {\n          status: Status.METHOD_ASYNC\n        });\n        return cb;\n      }\n    };\n\n    // invoke method\n    let result = methodObj.method(params, cb.done, cb.error);\n\n    // stop here if method works asynchronously\n    if (methodObj.isAsync) {\n      return;\n    }\n\n    // undefined result should work as success by documentation\n    if (result === undefined) {\n      result = true;\n    }\n\n    if (result === false || result === null) {\n      return cb.error();\n    }\n    return cb.done(result);\n  }\n\n  /**\n   * send `success` response to the provider\n   * @param id\n   * @param data\n   */\n  _sendResult(id, data) {\n    this._service.post({\n      jsonrpc: \"2.0\",\n      id,\n      result: data,\n    });\n  }\n\n  /**\n   * send `error` response to the provider\n   * @param id\n   * @param data\n   */\n  _sendError(id, data) {\n    this._service.post({\n      jsonrpc: \"2.0\",\n      id,\n      error: data,\n    });\n  }\n\n  destroy() {\n    this._service.destroy();\n    this._methods = {};\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/role/Server.js","\nexport * from './role/Server'\nexport * from './service/index'\n\n\n// WEBPACK FOOTER //\n// ./src/server.js"],"sourceRoot":""}