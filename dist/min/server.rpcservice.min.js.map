{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6","webpack:///server.rpcservice.min.js","webpack:///webpack/bootstrap 5fae2548c0be4ed4bccd?b0ea","webpack:///./src/service/ServiceStub.js?3e7b","webpack:///./src/util/Type.js?cda2","webpack:///./src/util/Status.js?d157","webpack:///./src/service/index.js?d231","webpack:///./src/util/index.js?6684","webpack:///./src/service/CustomEventService.js?0c83","webpack:///./src/service/LocalStorageService.js?1a2e","webpack:///./src/service/PostMessageService.js?9987","webpack:///./src/service/WKWebViewService.js?0660","webpack:///./src/role/Server.js","webpack:///./src/server.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_interopRequireDefault","obj","default","_classCallCheck","instance","Constructor","TypeError","ServiceStub","undefined","_Type","_Type2","options","_type","type","_receiveListener","receiveMessageCallback","isClient","CLIENT","isServer","SERVER","getServiceName","post","dispatch","data","Type","Status","METHOD_NOT_FOUND","METHOD_SUCCESS","METHOD_ERROR","METHOD_ASYNC","METHOD_READY","METHOD_DESTROY","METHOD_TIMEOUT","_ServiceStub","_CustomEventService","CustomEventService","_LocalStorageService","LocalStorageService","_PostMessageService","PostMessageService","_WKWebViewService","WKWebViewService","_Status","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","writable","setPrototypeOf","__proto__","_ServiceStub2","CustomEvent","event","params","bubbles","cancelable","detail","evt","document","createEvent","initCustomEvent","window","Event","arguments","length","_this","_sourceElement","source","_targetElement","target","_eventName","addEventListener","bind","ev","dispatchEvent","_ref","destroy","removeEventListener","usedStorageKeys","_storageKey","storageKey","localStorage","removeItem","time","Date","getTime","setItem","JSON","stringify","key","newValue","parse","e","_targetWindow","_sourceWindow","_origin","origin","_verifySource","postMessage","_namespace","namespace","_callback","callbackName","hasMsgHandler","webkit","messageHandlers","strData","Server","methods","service","_connectionEstablished","_onReady","onReady","_receiveMessage","_serviceClass","_service","_token","_methods","addMethod","methodName","methodFn","removeMethod","jsonrpc","id","method","verify","token","test","_sendError","status","message","that","cb","done","_sendResult","error","methodObj","isAsync","async","result","_Server","keys","forEach","_index","_index2"],"mappings":"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","file":"server.rpcservice.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"RPCService\"] = factory();\n\telse\n\t\troot[\"RPCService\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"RPCService\"] = factory();\n\telse\n\t\troot[\"RPCService\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 16);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ServiceStub = undefined;\n\nvar _Type = __webpack_require__(1);\n\nvar _Type2 = _interopRequireDefault(_Type);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ServiceStub = exports.ServiceStub = function () {\n  function ServiceStub(options) {\n    _classCallCheck(this, ServiceStub);\n\n    this._type = options.type;\n    this._receiveListener = options.receiveMessageCallback;\n  }\n\n  ServiceStub.prototype.isClient = function isClient() {\n    return this._type === _Type2.default.CLIENT;\n  };\n\n  ServiceStub.prototype.isServer = function isServer() {\n    return this._type === _Type2.default.SERVER;\n  };\n\n  /**\n   *\n   */\n\n\n  ServiceStub.getServiceName = function getServiceName() {\n    throw \"not implemented yet\";\n  };\n\n  /**\n   * to be implemented in the subclass\n   */\n\n\n  ServiceStub.prototype.post = function post() {\n    throw \"post not implemented yet\";\n  };\n\n  /**\n   * forward dispatched data the registered listener\n   * @param data\n   */\n\n\n  ServiceStub.prototype.dispatch = function dispatch(data) {\n    this._receiveListener(data);\n  };\n\n  return ServiceStub;\n}();\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar Type = exports.Type = {\n  SERVER: 'SERVER',\n  CLIENT: 'CLIENT'\n};\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar Status = exports.Status = {\n  METHOD_NOT_FOUND: 'METHOD_NOT_FOUND',\n  METHOD_SUCCESS: 'METHOD_SUCCESS',\n  METHOD_ERROR: 'METHOD_ERROR',\n  METHOD_ASYNC: 'METHOD_ASYNC',\n  METHOD_READY: 'METHOD_READY',\n  METHOD_DESTROY: 'METHOD_DESTROY',\n  METHOD_TIMEOUT: 'METHOD_TIMEOUT'\n};\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _ServiceStub = __webpack_require__(0);\n\nObject.defineProperty(exports, 'ServiceStub', {\n  enumerable: true,\n  get: function get() {\n    return _ServiceStub.ServiceStub;\n  }\n});\n\nvar _CustomEventService = __webpack_require__(5);\n\nObject.defineProperty(exports, 'CustomEventService', {\n  enumerable: true,\n  get: function get() {\n    return _CustomEventService.CustomEventService;\n  }\n});\n\nvar _LocalStorageService = __webpack_require__(6);\n\nObject.defineProperty(exports, 'LocalStorageService', {\n  enumerable: true,\n  get: function get() {\n    return _LocalStorageService.LocalStorageService;\n  }\n});\n\nvar _PostMessageService = __webpack_require__(7);\n\nObject.defineProperty(exports, 'PostMessageService', {\n  enumerable: true,\n  get: function get() {\n    return _PostMessageService.PostMessageService;\n  }\n});\n\nvar _WKWebViewService = __webpack_require__(8);\n\nObject.defineProperty(exports, 'WKWebViewService', {\n  enumerable: true,\n  get: function get() {\n    return _WKWebViewService.WKWebViewService;\n  }\n});\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _Status = __webpack_require__(2);\n\nObject.defineProperty(exports, 'Status', {\n  enumerable: true,\n  get: function get() {\n    return _Status.Status;\n  }\n});\n\nvar _Type = __webpack_require__(1);\n\nObject.defineProperty(exports, 'Type', {\n  enumerable: true,\n  get: function get() {\n    return _Type.Type;\n  }\n});\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CustomEventService = undefined;\n\nvar _ServiceStub2 = __webpack_require__(0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n// polyfill for IE 10\n(function () {\n\n  if (typeof window.CustomEvent === \"function\") return false;\n\n  function CustomEvent(event, params) {\n    params = params || { bubbles: false, cancelable: false, detail: undefined };\n    var evt = document.createEvent('CustomEvent');\n    evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n    return evt;\n  }\n\n  CustomEvent.prototype = window.Event.prototype;\n  window.CustomEvent = CustomEvent;\n})();\n\nvar CustomEventService = exports.CustomEventService = function (_ServiceStub) {\n  _inherits(CustomEventService, _ServiceStub);\n\n  function CustomEventService() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, CustomEventService);\n\n    var _this = _possibleConstructorReturn(this, _ServiceStub.call(this, options));\n\n    _this._sourceElement = options.source || window;\n    _this._targetElement = options.target || _this._sourceElement;\n    _this._eventName = options.event || 'message';\n\n    _this._sourceElement.addEventListener(_this._eventName, _this.dispatch.bind(_this), false);\n    return _this;\n  }\n\n  CustomEventService.getServiceName = function getServiceName() {\n    return 'CustomEventService';\n  };\n\n  /**\n   * Send a message by using `postMessage` service.\n   * @param {object} data\n   */\n\n\n  CustomEventService.prototype.post = function post(data) {\n    data.source = this._type;\n    var ev = new CustomEvent(this._eventName, {\n      detail: data\n    });\n    this._targetElement.dispatchEvent(ev);\n  };\n\n  /**\n   * Handles received messages\n   * @param {object} detail\n   * @returns {*}\n   */\n\n\n  CustomEventService.prototype.dispatch = function dispatch(_ref) {\n    var detail = _ref.detail;\n\n    // ensure provider or customer doesn't dispatch its own message\n    if (detail && detail.source !== this._type) {\n      delete detail.source;\n      _ServiceStub.prototype.dispatch.call(this, detail);\n    }\n  };\n\n  /**\n   * remove bindings\n   */\n\n\n  CustomEventService.prototype.destroy = function destroy() {\n    this._sourceElement.removeEventListener(this._eventName, this.dispatch);\n  };\n\n  return CustomEventService;\n}(_ServiceStub2.ServiceStub);\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.LocalStorageService = undefined;\n\nvar _ServiceStub2 = __webpack_require__(0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar usedStorageKeys = {};\n\nvar LocalStorageService = exports.LocalStorageService = function (_ServiceStub) {\n  _inherits(LocalStorageService, _ServiceStub);\n\n  function LocalStorageService(options) {\n    _classCallCheck(this, LocalStorageService);\n\n    var _this = _possibleConstructorReturn(this, _ServiceStub.call(this, options));\n\n    _this._storageKey = options.storageKey || 'rpc:message';\n\n    if (usedStorageKeys[_this._storageKey]) {\n      throw 'LocalStorageService: key \\'' + _this._storageKey + '\\' is already in use by another LocalStorageService';\n    }\n    usedStorageKeys[_this._storageKey] = true;\n\n    // remove old data if exists\n    localStorage.removeItem(_this._storageKey);\n\n    window.addEventListener('storage', _this.dispatch.bind(_this), false);\n    return _this;\n  }\n\n  LocalStorageService.getServiceName = function getServiceName() {\n    return 'LocalStorageService';\n  };\n\n  /**\n   * Send a message by using `localStorage`\n   * @param {object} data\n   */\n\n\n  LocalStorageService.prototype.post = function post(data) {\n    data.time = new Date().getTime();\n    data.source = this._type;\n    localStorage.setItem(this._storageKey, JSON.stringify(data));\n  };\n\n  /**\n   * Handles received messages\n   * @param key\n   * @param newValue\n   */\n\n\n  LocalStorageService.prototype.dispatch = function dispatch(_ref) {\n    var key = _ref.key,\n        newValue = _ref.newValue;\n\n\n    if (newValue && key === this._storageKey) {\n      try {\n        var data = JSON.parse(newValue);\n        delete data.time;\n\n        // ensure provider or customer doesn't dispatch its own message\n        if (data.source !== this._type) {\n          delete data.source;\n          _ServiceStub.prototype.dispatch.call(this, data);\n        }\n      } catch (e) {}\n    }\n  };\n\n  /**\n   * remove bindings\n   */\n\n\n  LocalStorageService.prototype.destroy = function destroy() {\n    window.removeEventListener('storage', this.dispatch);\n    localStorage.removeItem(this._storageKey);\n  };\n\n  return LocalStorageService;\n}(_ServiceStub2.ServiceStub);\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PostMessageService = undefined;\n\nvar _ServiceStub2 = __webpack_require__(0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar PostMessageService = exports.PostMessageService = function (_ServiceStub) {\n  _inherits(PostMessageService, _ServiceStub);\n\n  function PostMessageService() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, PostMessageService);\n\n    var _this = _possibleConstructorReturn(this, _ServiceStub.call(this, options));\n\n    _this._targetWindow = options.target || null;\n    _this._sourceWindow = options.source || window;\n    _this._origin = options.origin || \"*\";\n    _this._verifySource = _this._origin !== '*';\n\n    _this._sourceWindow.addEventListener('message', _this.dispatch.bind(_this), false);\n    return _this;\n  }\n\n  PostMessageService.getServiceName = function getServiceName() {\n    return 'PostMessageService';\n  };\n\n  /**\n   * Send a message by using `postMessage` service.\n   * @param {object} data\n   */\n\n\n  PostMessageService.prototype.post = function post(data) {\n\n    if (this._targetWindow === null) {\n      throw \"windows element for posting messages does not exist\";\n    }\n\n    this._targetWindow.postMessage(data, this._origin);\n  };\n\n  /**\n   * Handles received messages\n   * @param {string} origin\n   * @param {object} data\n   * @param {window} source\n   * @returns {*}\n   */\n\n\n  PostMessageService.prototype.dispatch = function dispatch(_ref) {\n    var origin = _ref.origin,\n        data = _ref.data,\n        source = _ref.source;\n\n\n    if (this._verifySource && this._origin !== origin) {\n      return null;\n    }\n\n    _ServiceStub.prototype.dispatch.call(this, data);\n  };\n\n  /**\n   * remove bindings\n   */\n\n\n  PostMessageService.prototype.destroy = function destroy() {\n    this._sourceWindow.removeEventListener('message', this.dispatch);\n  };\n\n  return PostMessageService;\n}(_ServiceStub2.ServiceStub);\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.WKWebViewService = undefined;\n\nvar _ServiceStub2 = __webpack_require__(0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar WKWebViewService = exports.WKWebViewService = function (_ServiceStub) {\n  _inherits(WKWebViewService, _ServiceStub);\n\n  function WKWebViewService() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, WKWebViewService);\n\n    var _this = _possibleConstructorReturn(this, _ServiceStub.call(this, options));\n\n    _this._namespace = options.namespace;\n    _this._callback = options.callbackName || 'rpcReceiveCallback';\n    var hasMsgHandler = false;\n\n    // check if special WKWebView message handler exists\n    try {\n      hasMsgHandler = typeof window.webkit.messageHandlers[_this._namespace].postMessage === 'function';\n    } catch (e) {}\n\n    if (!hasMsgHandler) {\n      throw 'WKWebViewService: cannot connect to WKWebView handler \\'window.webkit.messageHandlers.' + _this._namespace + '\\'';\n    }\n\n    // register callback function (works as response listener)\n    window[_this._callback] = _this.dispatch.bind(_this);\n    return _this;\n  }\n\n  WKWebViewService.getServiceName = function getServiceName() {\n    return 'WKWebViewService';\n  };\n\n  /**\n   * Send a message by using `postMessage` service.\n   * @param {object} data\n   */\n\n\n  WKWebViewService.prototype.post = function post(data) {\n    window.webkit.messageHandlers[this._namespace].postMessage(JSON.stringify(data));\n  };\n\n  /**\n   * Handles received messages\n   * @param {string} strData\n   * @returns {*}\n   */\n\n\n  WKWebViewService.prototype.dispatch = function dispatch(strData) {\n    try {\n      _ServiceStub.prototype.dispatch.call(this, JSON.parse(strData));\n    } catch (e) {}\n  };\n\n  /**\n   * remove bindings\n   */\n\n\n  WKWebViewService.prototype.destroy = function destroy() {\n    delete window[this._namespace];\n  };\n\n  return WKWebViewService;\n}(_ServiceStub2.ServiceStub);\n\n/***/ }),\n/* 9 */,\n/* 10 */,\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Server = undefined;\n\nvar _Status = __webpack_require__(2);\n\nvar _Type = __webpack_require__(1);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Server = exports.Server = function () {\n\n  /**\n   *\n   * @param options -\n   * @param methods - function map\n   */\n  function Server(options) {\n    var methods = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Server);\n\n    if (!options.service) {\n      throw \"missing option 'service' for service class\";\n    }\n\n    this._connectionEstablished = false;\n    this._onReady = typeof options.onReady === 'function' ? options.onReady : null;\n\n    options.type = _Type.Type.SERVER;\n    options.receiveMessageCallback = this._receiveMessage.bind(this);\n\n    this._serviceClass = options.service;\n    this._service = new this._serviceClass(options);\n    this._token = null;\n    this._methods = methods;\n  }\n\n  /**\n   * register given callback function with `methodName`\n   * @param methodName\n   * @param methodFn\n   * @returns {Consumer}\n   */\n\n\n  Server.prototype.addMethod = function addMethod(methodName, methodFn) {\n    this._methods[methodName] = methodFn;\n    return this;\n  };\n\n  /**\n   * Remove callback function with given `methodName`\n   * @param methodName\n   */\n\n\n  Server.prototype.removeMethod = function removeMethod(methodName) {\n    if (this._methods[methodName]) {\n      delete this._methods[methodName];\n    }\n    return this;\n  };\n\n  /**\n   * Handles a message sent by a provider and invoke the method.\n   * @param jsonrpc\n   * @param id\n   * @param method\n   * @param params\n   * @param verify\n   * @param token\n   * @param test\n   * @returns {*}\n   * @private\n   */\n\n\n  Server.prototype._receiveMessage = function _receiveMessage(_ref) {\n    var jsonrpc = _ref.jsonrpc,\n        id = _ref.id,\n        method = _ref.method,\n        params = _ref.params,\n        verify = _ref.verify,\n        token = _ref.token,\n        test = _ref.test;\n\n\n    if (!this._connectionEstablished && verify && id) {\n      this._connectionEstablished = true;\n      this._token = id;\n      this._service.post({\n        verify: verify,\n        id: id\n      });\n      if (this._onReady) {\n        this._onReady();\n      }\n    }\n\n    // check JSON RPC format for answer\n    if (!this._connectionEstablished || jsonrpc !== \"2.0\" || !id || !method || token !== this._token) {\n      return;\n    }\n\n    // message with given id does not exist\n    if (!this._methods[method]) {\n      return this._sendError(id, {\n        status: _Status.Status.METHOD_NOT_FOUND,\n        message: 'method with name ' + method + ' could not be found'\n      });\n    }\n\n    var that = this;\n    var cb = {\n      done: function done(data) {\n        that._sendResult(id, {\n          status: _Status.Status.METHOD_SUCCESS,\n          data: data\n        });\n      },\n      error: function error(data) {\n        that._sendResult(id, {\n          status: _Status.Status.METHOD_ERROR,\n          data: data\n        });\n      }\n    };\n    var methodObj = {\n      method: this._methods[method],\n      isAsync: false,\n      async: function async() {\n        this.isAsync = true;\n        that._sendResult(id, {\n          status: _Status.Status.METHOD_ASYNC\n        });\n        return cb;\n      }\n    };\n\n    // invoke method\n    var result = methodObj.method(params, cb.done, cb.error);\n\n    // stop here if method works asynchronously\n    if (methodObj.isAsync) {\n      return;\n    }\n\n    // undefined result should work as success by documentation\n    if (result === undefined) {\n      result = true;\n    }\n\n    if (result === false || result === null) {\n      return cb.error();\n    }\n    return cb.done(result);\n  };\n\n  /**\n   * send `success` response to the provider\n   * @param id\n   * @param data\n   */\n\n\n  Server.prototype._sendResult = function _sendResult(id, data) {\n    this._service.post({\n      jsonrpc: \"2.0\",\n      id: id,\n      result: data\n    });\n  };\n\n  /**\n   * send `error` response to the provider\n   * @param id\n   * @param data\n   */\n\n\n  Server.prototype._sendError = function _sendError(id, data) {\n    this._service.post({\n      jsonrpc: \"2.0\",\n      id: id,\n      error: data\n    });\n  };\n\n  Server.prototype.destroy = function destroy() {\n    this._service.destroy();\n    this._methods = {};\n  };\n\n  return Server;\n}();\n\n/***/ }),\n/* 12 */,\n/* 13 */,\n/* 14 */,\n/* 15 */,\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _Server = __webpack_require__(11);\n\nObject.keys(_Server).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _Server[key];\n    }\n  });\n});\n\nvar _index = __webpack_require__(3);\n\nObject.keys(_index).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _index[key];\n    }\n  });\n});\n\nvar _index2 = __webpack_require__(4);\n\nObject.keys(_index2).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _index2[key];\n    }\n  });\n});\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// server.rpcservice.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 16);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5fae2548c0be4ed4bccd","import Type from '../util/Type'\n\nexport class ServiceStub {\n\n  constructor(options) {\n    this._type = options.type;\n    this._receiveListener = options.receiveMessageCallback;\n  }\n\n  isClient() {\n    return this._type === Type.CLIENT;\n  }\n\n  isServer() {\n    return this._type === Type.SERVER;\n  }\n\n  /**\n   *\n   */\n  static getServiceName() {\n    throw \"not implemented yet\";\n  }\n\n  /**\n   * to be implemented in the subclass\n   */\n  post() {\n    throw \"post not implemented yet\";\n  }\n\n  /**\n   * forward dispatched data the registered listener\n   * @param data\n   */\n  dispatch(data) {\n    this._receiveListener(data);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/ServiceStub.js","\nexport const Type = {\n  SERVER: 'SERVER',\n  CLIENT: 'CLIENT'\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/Type.js","\nexport const Status = {\n  METHOD_NOT_FOUND: 'METHOD_NOT_FOUND',\n  METHOD_SUCCESS: 'METHOD_SUCCESS',\n  METHOD_ERROR: 'METHOD_ERROR',\n  METHOD_ASYNC: 'METHOD_ASYNC',\n  METHOD_READY: 'METHOD_READY',\n  METHOD_DESTROY: 'METHOD_DESTROY',\n  METHOD_TIMEOUT: 'METHOD_TIMEOUT'\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/Status.js","\nexport {ServiceStub} from './ServiceStub';\nexport {CustomEventService} from './CustomEventService';\nexport {LocalStorageService} from './LocalStorageService';\nexport {PostMessageService} from './PostMessageService';\nexport {WKWebViewService} from './WKWebViewService';\n\n\n// WEBPACK FOOTER //\n// ./src/service/index.js","\nexport {Status} from './Status'\nexport {Type} from './Type'\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/index.js","import {ServiceStub} from './ServiceStub';\n\n// polyfill for IE 10\n(function () {\n\n  if ( typeof window.CustomEvent === \"function\" ) return false;\n\n  function CustomEvent(event, params) {\n    params = params || { bubbles: false, cancelable: false, detail: undefined };\n    var evt = document.createEvent('CustomEvent');\n    evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n    return evt;\n  }\n\n  CustomEvent.prototype = window.Event.prototype;\n  window.CustomEvent = CustomEvent;\n})();\n\n\nexport class CustomEventService extends ServiceStub {\n\n  constructor(options = {}) {\n    super(options);\n\n    this._sourceElement = options.source || window;\n    this._targetElement = options.target || this._sourceElement;\n    this._eventName     = options.event || 'message';\n\n    this._sourceElement.addEventListener(this._eventName, this.dispatch.bind(this), false);\n  }\n\n  static getServiceName() {\n    return 'CustomEventService'\n  }\n\n  /**\n   * Send a message by using `postMessage` service.\n   * @param {object} data\n   */\n  post(data) {\n    data.source = this._type;\n    const ev = new CustomEvent(this._eventName, {\n      detail: data\n    });\n    this._targetElement.dispatchEvent(ev);\n  }\n\n  /**\n   * Handles received messages\n   * @param {object} detail\n   * @returns {*}\n   */\n  dispatch({detail}) {\n    // ensure provider or customer doesn't dispatch its own message\n    if (detail && detail.source !== this._type) {\n      delete detail.source;\n      super.dispatch(detail);\n    }\n  }\n\n  /**\n   * remove bindings\n   */\n  destroy() {\n    this._sourceElement.removeEventListener(this._eventName, this.dispatch);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/CustomEventService.js","import {ServiceStub} from './ServiceStub';\n\nlet usedStorageKeys = {};\n\nexport class LocalStorageService extends ServiceStub {\n\n  constructor(options) {\n    super(options);\n\n    this._storageKey = options.storageKey || 'rpc:message';\n\n    if (usedStorageKeys[this._storageKey]) {\n      throw `LocalStorageService: key '${this._storageKey}' is already in use by another LocalStorageService`;\n    }\n    usedStorageKeys[this._storageKey] = true;\n\n    // remove old data if exists\n    localStorage.removeItem(this._storageKey);\n\n    window.addEventListener('storage', this.dispatch.bind(this), false);\n  }\n\n  static getServiceName() {\n    return 'LocalStorageService'\n  }\n\n  /**\n   * Send a message by using `localStorage`\n   * @param {object} data\n   */\n  post(data) {\n    data.time = new Date().getTime();\n    data.source = this._type;\n    localStorage.setItem(this._storageKey, JSON.stringify(data));\n  }\n\n  /**\n   * Handles received messages\n   * @param key\n   * @param newValue\n   */\n  dispatch({key, newValue}) {\n\n    if (newValue && key === this._storageKey) {\n      try {\n        const data = JSON.parse(newValue);\n        delete data.time;\n\n        // ensure provider or customer doesn't dispatch its own message\n        if (data.source !== this._type) {\n          delete data.source;\n          super.dispatch(data);\n        }\n      } catch(e) {}\n    }\n  }\n\n  /**\n   * remove bindings\n   */\n  destroy() {\n    window.removeEventListener('storage', this.dispatch);\n    localStorage.removeItem(this._storageKey);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/LocalStorageService.js","import {ServiceStub} from './ServiceStub';\n\nexport class PostMessageService extends ServiceStub {\n\n  constructor(options = {}) {\n    super(options);\n\n    this._targetWindow = options.target || null;\n    this._sourceWindow = options.source || window;\n    this._origin       = options.origin || \"*\";\n    this._verifySource = this._origin !== '*';\n\n    this._sourceWindow.addEventListener('message', this.dispatch.bind(this), false);\n  }\n\n  static getServiceName() {\n    return 'PostMessageService'\n  }\n\n  /**\n   * Send a message by using `postMessage` service.\n   * @param {object} data\n   */\n  post(data) {\n\n    if (this._targetWindow === null) {\n      throw \"windows element for posting messages does not exist\";\n    }\n\n    this._targetWindow.postMessage(data, this._origin);\n  }\n\n  /**\n   * Handles received messages\n   * @param {string} origin\n   * @param {object} data\n   * @param {window} source\n   * @returns {*}\n   */\n  dispatch({origin, data, source}) {\n\n    if (this._verifySource && this._origin !== origin) {\n      return null;\n    }\n\n    super.dispatch(data);\n  }\n\n  /**\n   * remove bindings\n   */\n  destroy() {\n    this._sourceWindow.removeEventListener('message', this.dispatch);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/PostMessageService.js","import {ServiceStub} from './ServiceStub';\n\nexport class WKWebViewService extends ServiceStub {\n\n  constructor(options = {}) {\n    super(options);\n\n    this._namespace = options.namespace;\n    this._callback = options.callbackName || 'rpcReceiveCallback';\n    let hasMsgHandler = false;\n\n    // check if special WKWebView message handler exists\n    try {\n      hasMsgHandler = (typeof window.webkit.messageHandlers[this._namespace].postMessage === 'function');\n    } catch(e) {}\n\n    if (!hasMsgHandler) {\n      throw `WKWebViewService: cannot connect to WKWebView handler 'window.webkit.messageHandlers.${this._namespace}'`;\n    }\n\n    // register callback function (works as response listener)\n    window[this._callback] = this.dispatch.bind(this);\n  }\n\n  static getServiceName() {\n    return 'WKWebViewService'\n  }\n\n  /**\n   * Send a message by using `postMessage` service.\n   * @param {object} data\n   */\n  post(data) {\n    window.webkit.messageHandlers[this._namespace].postMessage(JSON.stringify(data));\n  }\n\n  /**\n   * Handles received messages\n   * @param {string} strData\n   * @returns {*}\n   */\n  dispatch(strData) {\n    try {\n      super.dispatch(JSON.parse(strData));\n    } catch(e) {}\n  }\n\n  /**\n   * remove bindings\n   */\n  destroy() {\n    delete window[this._namespace];\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/service/WKWebViewService.js","import {Status} from '../util/Status';\nimport {Type} from '../util/Type';\n\n\nexport class Server {\n\n  /**\n   *\n   * @param options -\n   * @param methods - function map\n   */\n  constructor(options, methods = {}) {\n\n    if (!options.service) {\n      throw \"missing option 'service' for service class\"\n    }\n\n    this._connectionEstablished = false;\n    this._onReady = typeof options.onReady === 'function' ? options.onReady : null;\n\n    options.type = Type.SERVER;\n    options.receiveMessageCallback = this._receiveMessage.bind(this);\n\n    this._serviceClass = options.service;\n    this._service = new this._serviceClass(options);\n    this._token = null;\n    this._methods = methods;\n  }\n\n  /**\n   * register given callback function with `methodName`\n   * @param methodName\n   * @param methodFn\n   * @returns {Consumer}\n   */\n  addMethod(methodName, methodFn) {\n    this._methods[methodName] = methodFn;\n    return this;\n  }\n\n  /**\n   * Remove callback function with given `methodName`\n   * @param methodName\n   */\n  removeMethod(methodName) {\n    if (this._methods[methodName]) {\n      delete this._methods[methodName];\n    }\n    return this;\n  }\n\n  /**\n   * Handles a message sent by a provider and invoke the method.\n   * @param jsonrpc\n   * @param id\n   * @param method\n   * @param params\n   * @param verify\n   * @param token\n   * @param test\n   * @returns {*}\n   * @private\n   */\n  _receiveMessage({jsonrpc, id, method, params, verify, token, test}) {\n\n    if (!this._connectionEstablished && verify && id) {\n      this._connectionEstablished = true;\n      this._token = id;\n      this._service.post({\n        verify,\n        id\n      });\n      if (this._onReady) {\n        this._onReady();\n      }\n    }\n\n    // check JSON RPC format for answer\n    if (!this._connectionEstablished || jsonrpc !== \"2.0\" || !id || !method || token !== this._token) {\n      return;\n    }\n\n    // message with given id does not exist\n    if (!this._methods[method]) {\n      return this._sendError(id, {\n        status: Status.METHOD_NOT_FOUND,\n        message: `method with name ${method} could not be found`\n      });\n    }\n\n    const that = this;\n    const cb = {\n      done(data) {\n        that._sendResult(id, {\n          status: Status.METHOD_SUCCESS,\n          data,\n        });\n      },\n      error(data) {\n        that._sendResult(id, {\n          status: Status.METHOD_ERROR,\n          data,\n        });\n      }\n    };\n    const methodObj = {\n      method: this._methods[method],\n      isAsync: false,\n      async: function() {\n        this.isAsync = true;\n        that._sendResult(id, {\n          status: Status.METHOD_ASYNC\n        });\n        return cb;\n      }\n    };\n\n    // invoke method\n    let result = methodObj.method(params, cb.done, cb.error);\n\n    // stop here if method works asynchronously\n    if (methodObj.isAsync) {\n      return;\n    }\n\n    // undefined result should work as success by documentation\n    if (result === undefined) {\n      result = true;\n    }\n\n    if (result === false || result === null) {\n      return cb.error();\n    }\n    return cb.done(result);\n  }\n\n  /**\n   * send `success` response to the provider\n   * @param id\n   * @param data\n   */\n  _sendResult(id, data) {\n    this._service.post({\n      jsonrpc: \"2.0\",\n      id,\n      result: data,\n    });\n  }\n\n  /**\n   * send `error` response to the provider\n   * @param id\n   * @param data\n   */\n  _sendError(id, data) {\n    this._service.post({\n      jsonrpc: \"2.0\",\n      id,\n      error: data,\n    });\n  }\n\n  destroy() {\n    this._service.destroy();\n    this._methods = {};\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/role/Server.js","\nexport * from './role/Server'\nexport * from './service/index'\nexport * from './util/index'\n\n\n// WEBPACK FOOTER //\n// ./src/server.js"],"sourceRoot":""}